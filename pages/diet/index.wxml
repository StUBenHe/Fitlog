<view class="container">

<!-- é¡¶éƒ¨æ ï¼ˆä»…æ¸…å•ç•Œé¢æ˜¾ç¤ºï¼‰ -->
<view wx:if="{{step === 0}}" class="bottom-back">
  <text class="back-btn" bindtap="onPageBack">â† ä¿å­˜</text>
  <text class="top-title">è¿”å›</text>
</view>

<!-- âœ… æ°¸è¿œæ˜¾ç¤ºçš„åŠ å· -->
<view class="add-btn" bindtap="onAddClick">
  ï¼‹ æ·»åŠ é£Ÿç‰©
</view>

<!-- ç¬¬ä¸€å±‚ï¼šåˆ†ç±»ï¼ˆç”¨ä½ åŸæ¥çš„ panel åŒ…èµ·æ¥ï¼Œé¿å…æ ·å¼ä¸¢å¤±ï¼‰ -->
<view wx:if="{{step === 1}}" class="panel">
  <view class="panel-header">
    <text class="back" bindtap="onBack">â† è¿”å›</text>
    <text class="title">é€‰æ‹©åˆ†ç±»</text>
  </view>

  <view class="category-grid">
    <view
      wx:for="{{foodCategories}}"
      wx:key="id"
      class="category-item"
      bindtap="onCategoryClick"
      data-category="{{item}}"
    >
      {{item.name}}
    </view>
  </view>
</view>

<!-- ç¬¬äºŒå±‚ï¼šé£Ÿç‰© -->
<view wx:if="{{step === 2}}" class="panel">
  <view class="panel-header">
    <text class="back" bindtap="onBack">â† è¿”å›</text>
    <text class="title">{{currentCategory.name}}</text>
  </view>

  <view class="item-grid">
    <view
      wx:for="{{currentCategory.items}}"
      wx:key="id"
      class="item"
      bindtap="onItemClick"
      data-item="{{item}}"
    >
      {{item.name}}
    </view>
  </view>
</view>

<!-- ç¬¬ä¸‰å±‚ï¼šæ•°é‡ -->
<view wx:if="{{step === 3}}" class="amount-panel">

  <view class="food-name">
    {{currentItem.name}}
  </view>

  <!-- ä»½é‡å¤‡æ³¨ -->
  <view wx:if="{{currentItem.displayNote}}" class="note">
    {{currentItem.displayNote}}
  </view>

  <view class="stepper">
    <view class="btn" bindtap="onMinus">âˆ’</view>
    <view class="amount">
      {{amount}} {{currentItem.unit}}
    </view>
    <view class="btn" bindtap="onPlus">ï¼‹</view>
  </view>

  <!-- çƒ­é‡ -->
  <view class="kcal">
    ğŸ”¥çƒ­é‡â‰ˆ {{kcal}} kcal
  </view>

  <!-- è›‹ç™½è´¨ -->
  <view class="protein">
    ğŸ’ª è›‹ç™½è´¨ â‰ˆ {{protein}} g
  </view>

  <view class="confirm-btn" bindtap="onConfirm">
    ç¡®è®¤æ·»åŠ 
  </view>

  <!-- step 3 ä¹Ÿæä¾›è¿”å›ï¼ˆå¦‚æœä½ åŸæ¥ä¾èµ–å®ƒï¼‰ -->
  <view class="back-inline" bindtap="onBack">
    â† è¿”å›
  </view>


</view>

<!-- å·²æ·»åŠ çš„é¥®é£Ÿåˆ—è¡¨ï¼ˆæ¸…å•ç•Œé¢æ˜¾ç¤ºï¼‰ -->
<view class="diet-list" wx:if="{{step === 0 && dietEntries.length > 0}}">

  <view class="diet-header">
    <text>é£Ÿç‰©</text>
    <text>æ•°é‡</text>
    <text>çƒ­é‡</text>
    <text>è›‹ç™½è´¨</text>
  </view>

  <view
    class="diet-row"
    wx:for="{{dietEntries}}"
    wx:key="id"
  >
    <text>{{item.name}}</text>
    <text>{{item.amount}} {{item.unit}}</text>
    <text>{{item.kcal}} kcal</text>
    <text>{{item.protein}} g</text>
  </view>

  <view class="diet-total">
  <view class="total-row">
    æ€»çƒ­é‡ï¼š{{totalKcal}} kcal
  </view>
  <view class="total-row">
    è›‹ç™½è´¨ï¼š{{totalProtein}} g
  </view>
</view>


</view>

</view>
